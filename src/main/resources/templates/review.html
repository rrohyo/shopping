<!DOCTYPE html>
        <html xmlns:th="http://www.thymeleaf.org">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <!-- CSRF (ìŠ¤í”„ë§ ì‹œíë¦¬í‹° ì‚¬ìš©í•  ê²½ìš° ìë™ ì£¼ì…ë¨) -->
            <meta name="_csrf" th:if="${_csrf != null}" th:content="${_csrf.token}"/>
            <meta name="_csrf_header" th:if="${_csrf != null}" th:content="${_csrf.headerName}"/>

            <title>ë¦¬ë·° ì‘ì„±</title>

            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px;
                }
                .review-container {
                    background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1);
                    max-width: 800px; width: 100%; overflow: hidden;
                }
                .review-header {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white; padding: 30px; text-align: center;
                }
                .review-title { font-size: 24px; font-weight: 600; margin-bottom: 8px; }
                .review-subtitle { font-size: 14px; opacity: 0.9; }

                .product-info {
                    padding: 25px 30px; background: #f8f9fa; border-bottom: 1px solid #e9ecef;
                    display: flex; align-items: center; gap: 20px;
                }
                .product-image {
                    width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    border-radius: 10px; display: flex; align-items: center; justify-content: center;
                    color: white; font-size: 36px; flex-shrink: 0;
                }
                .product-details { flex: 1; }
                .product-name { font-size: 18px; font-weight: 600; color: #333; margin-bottom: 5px; }
                .product-meta { font-size: 13px; color: #666; }

                .review-form { padding: 30px; }

                .help-box {
                    padding: 15px; background: #e7f3ff; border-left: 4px solid #667eea; border-radius: 5px; margin-bottom: 20px;
                }
                .help-title { font-size: 14px; font-weight: 600; color: #0066cc; margin-bottom: 8px; display: flex; align-items: center; gap: 5px; }
                .help-list { font-size: 13px; color: #555; line-height: 1.6; padding-left: 20px; }

                .content-section { margin-top: 10px; }
                .section-label { font-size: 16px; font-weight: 600; color: #333; margin-bottom: 10px; display: block; }
                textarea {
                    width: 100%; min-height: 200px; padding: 15px; border: 1px solid #dee2e6; border-radius: 10px;
                    font-size: 14px; font-family: inherit; resize: vertical; transition: all 0.3s;
                }
                textarea:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102,126,234,0.1); }
                textarea::placeholder { color: #999; }
                .char-counter { text-align: right; font-size: 12px; color: #999; margin-top: 5px; }

                .button-group {
                    display: flex; gap: 10px; margin-top: 30px; padding-top: 30px; border-top: 1px solid #e9ecef;
                }
                .btn {
                    flex: 1; padding: 14px 24px; border: none; border-radius: 8px; font-size: 16px; font-weight: 600;
                    cursor: pointer; transition: all 0.3s; text-decoration: none; display: inline-flex;
                    align-items: center; justify-content: center; gap: 8px;
                }
                .btn-primary {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;
                }
                .btn-primary:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(102,126,234,0.4); }
                .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
                .btn-secondary { background: #e9ecef; color: #495057; }
                .btn-secondary:hover { background: #dee2e6; }

                .alert { padding: 15px 20px; border-radius: 8px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
                .alert-warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
                .spinner {
                    display: inline-block; width: 16px; height: 16px; border: 2px solid rgba(255,255,255,0.3);
                    border-radius: 50%; border-top-color: white; animation: spin 1s linear infinite;
                }
                @keyframes spin { to { transform: rotate(360deg); } }

                @media (max-width: 768px) {
                    .product-info { flex-direction: column; text-align: center; }
                    .button-group { flex-direction: column; }
                }
            </style>
        </head>
        <body>
        <div class="review-container">
            <!-- í—¤ë” -->
            <div class="review-header">
                <h1 class="review-title">âœ¨ ë¦¬ë·° ì‘ì„±</h1>
                <p class="review-subtitle">êµ¬ë§¤í•˜ì‹  ìƒí’ˆì€ ì–´ë– ì…¨ë‚˜ìš”?</p>
            </div>

            <!-- ìƒí’ˆ ì •ë³´ -->
            <div class="product-info">
                <div class="product-image">ğŸ“¦</div>
                <div class="product-details">
                    <div class="product-name" th:text="${product.name}">ìƒí’ˆëª…</div>
                    <div class="product-meta">
                        íŒë§¤ì: <span th:text="${product.memberId != null ? product.memberId : 'íŒë§¤ì'}">íŒë§¤ì</span>
                    </div>
                </div>
            </div>

            <!-- ë¦¬ë·° ì‘ì„± í¼ -->
            <form id="reviewForm" th:action="@{/review/create}" method="post" class="review-form">
                <!-- í•„ìˆ˜ hidden -->
                <input type="hidden" name="productId" th:value="${product.id}" />

                <!-- CSRF -->
                <input type="hidden"
                       th:if="${_csrf != null}"
                       th:name="${_csrf.parameterName}"
                       th:value="${_csrf.token}" />

                <!-- ì—ëŸ¬ ë©”ì‹œì§€ -->
                <div th:if="${errorMessage != null}"
                     class="alert alert-warning"
                     th:text="${errorMessage}">
                </div>

                <!-- ë³„ì  ì„ íƒ -->
                <div class="rating-section">
                    <label class="section-label">ë³„ì  *</label>
                    <div>
                        <label><input type="radio" name="rating" value="1" required> â˜…</label>
                        <label><input type="radio" name="rating" value="2"> â˜…â˜…</label>
                        <label><input type="radio" name="rating" value="3"> â˜…â˜…â˜…</label>
                        <label><input type="radio" name="rating" value="4"> â˜…â˜…â˜…â˜…</label>
                        <label><input type="radio" name="rating" value="5"> â˜…â˜…â˜…â˜…â˜…</label>
                    </div>
                </div>

                <style>
                    .star-rating {
                        display: flex;
                        flex-direction: row-reverse;
                        justify-content: flex-end;
                    }
                    .star-rating input {
                        display: none;
                    }
                    .star-rating label {
                        font-size: 32px;
                        color: #ddd;
                        cursor: pointer;
                        transition: color 0.2s;
                    }
                    .star-rating input:checked ~ label,
                    .star-rating label:hover,
                    .star-rating label:hover ~ label {
                        color: #f5b301;
                    }
                </style>

                <!-- ë„ì›€ë§ -->
                <div class="help-box">
                    <div class="help-title">ğŸ’¡ ì¢‹ì€ ë¦¬ë·° ì‘ì„± íŒ</div>
                    <ul class="help-list">
                        <li>ìƒí’ˆì˜ ì¥ì /ë‹¨ì ì„ ì†”ì§í•˜ê²Œ ì‘ì„±í•´ì£¼ì„¸ìš”.</li>
                        <li>êµ¬ë§¤ ëª©ì ê³¼ ì‹¤ì œ ì‚¬ìš© ê²½í—˜ì„ ê³µìœ í•´ì£¼ì„¸ìš”.</li>
                        <li>ë‹¤ë¥¸ êµ¬ë§¤ìì—ê²Œ ë„ì›€ì´ ë  ì •ë³´ë¥¼ í¬í•¨í•´ì£¼ì„¸ìš”.</li>
                    </ul>
                </div>

                <!-- ë¦¬ë·° ë‚´ìš© -->
                <div class="content-section">
                    <label class="section-label">
                        ìƒì„¸ ë¦¬ë·° <span style="color:#e74c3c;">*</span>
                    </label>

                    <textarea id="reviewContent"
                              name="content"
                              placeholder="ìƒí’ˆ ì‚¬ìš© í›„ê¸°ë¥¼ ìì„¸íˆ ì‘ì„±í•´ì£¼ì„¸ìš”."
                              maxlength="1000"
                              required></textarea>

                    <div class="char-counter">
                        <span id="charCount">0</span> / 1000
                    </div>
                </div>

                <!-- ë²„íŠ¼ -->
                <div class="button-group">
                    <a th:href="@{/product/detail/{id}(id=${product.id})}"
                       class="btn btn-secondary">ì·¨ì†Œ</a>

                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <span id="btnText">ë¦¬ë·° ë“±ë¡</span>
                        <span class="spinner" id="btnSpinner" style="display:none;"></span>
                    </button>
                </div>

        <script th:inline="javascript">
            (function() {
    const params = new URLSearchParams(window.location.search);
    const tab = params.get('tab');
    if (tab) {
      // íƒ­ ë²„íŠ¼/íŒ¨ë„ í™œì„±í™” í•¨ìˆ˜ê°€ showTab(name)ì´ë¼ë©´:
      const btn = document.querySelector(`.tab-menu .tab-button[onclick*="${tab}"]`);
      if (btn) btn.click(); // ë²„íŠ¼ í´ë¦­ìœ¼ë¡œ í™œì„±í™”
      else if (typeof showTab === 'function') showTab(tab);
    }
  })();
            // ì œí’ˆ ID (ì„±ê³µ ì‹œ ìƒì„¸ë¡œ ëŒì•„ê°ˆ ë•Œ ì‚¬ìš© ê°€ëŠ¥)
            const productId = [[${product.id}]];

            // ê¸€ì ìˆ˜ ì¹´ìš´íŒ…
            const ta = document.getElementById('reviewContent');
            const counter = document.getElementById('charCount');
            ta.addEventListener('input', function () {
                counter.textContent = this.value.length;
            });

            // ì œì¶œ ë¡œë”© ì²˜ë¦¬
            const form = document.getElementById('reviewForm');
            form.addEventListener('submit', function (e) {
                e.preventDefault();

                const content = ta.value.trim();
                if (content.length < 1) {
                    alert('ë¦¬ë·° ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }

                const btnText = document.getElementById('btnText');
                const btnSpinner = document.getElementById('btnSpinner');
                const submitBtn = document.getElementById('submitBtn');
                btnText.style.display = 'none';
                btnSpinner.style.display = 'inline-block';
                submitBtn.disabled = true;

                this.submit();
            });
        </script>
        </body>
        </html>
    <!--<script th:inline="javascript">
        let selectedRating = 0;
        const productId = [[${product.id}]];
        const Create = [[${CreateReview}]];

        // ë³„ì  ì„¤ì •
        function setRating(rating) {
            if (!Create) {
                alert('ì´ë¯¸ ë¦¬ë·°ë¥¼ ì‘ì„±í•˜ì…¨ìŠµë‹ˆë‹¤.');
                return;
            }

            selectedRating = rating;
            document.getElementById('rating').value = rating;
            
            // ë³„ í‘œì‹œ ì—…ë°ì´íŠ¸
            const stars = document.querySelectorAll('.star');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.textContent = 'â˜…';
                    star.classList.add('active');
                } else {
                    star.textContent = 'â˜†';
                    star.classList.remove('active');
                }
            });
            
            // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            const ratingTexts = [
                '',
                'ë³„ë¡œì˜ˆìš” ğŸ˜',
                'ê·¸ì € ê·¸ë˜ìš” ğŸ˜',
                'ë³´í†µì´ì—ìš” ğŸ™‚',
                'ì¢‹ì•„ìš” ğŸ˜Š',
                'ìµœê³ ì˜ˆìš”! ğŸ¤©'
            ];
            
            const ratingDescriptions = [
                '',
                'ë§ì´ ì•„ì‰¬ìš´ ìƒí’ˆì´ì—ˆì–´ìš”',
                'ê¸°ëŒ€ì— ëª» ë¯¸ì¹˜ëŠ” ìƒí’ˆì´ì—ìš”',
                'ë¬´ë‚œí•˜ê²Œ ì‚¬ìš©í•  ë§Œí•´ìš”',
                'ë§Œì¡±ìŠ¤ëŸ¬ìš´ ìƒí’ˆì´ì—ìš”',
                'ê°•ë ¥ ì¶”ì²œí•˜ëŠ” ìƒí’ˆì´ì—ìš”!'
            ];
            
            document.getElementById('ratingText').textContent = ratingTexts[rating];
            document.getElementById('ratingDescription').textContent = ratingDescriptions[rating];
        }

        // ë³„ì  í˜¸ë²„ íš¨ê³¼
        document.querySelectorAll('.star').forEach((star, index) => {
            star.addEventListener('mouseenter', function() {
                if (!Create) return;
                
                const hoverRating = index + 1;
                document.querySelectorAll('.star').forEach((s, i) => {
                    if (i < hoverRating) {
                        s.textContent = 'â˜…';
                    } else {
                        s.textContent = 'â˜†';
                    }
                });
            });
        });

        document.querySelector('.star-rating').addEventListener('mouseleave', function() {
            if (!Create) return;
            
            // ì„ íƒëœ ë³„ì ìœ¼ë¡œ ë³µì›
            document.querySelectorAll('.star').forEach((star, index) => {
                if (index < selectedRating) {
                    star.textContent = 'â˜…';
                } else {
                    star.textContent = 'â˜†';
                }
            });
        });

        // ê¸€ì ìˆ˜ ì¹´ìš´í„°
        document.getElementById('reviewContent').addEventListener('input', function() {
            const length = this.value.length;
            document.getElementById('charCount').textContent = length;
        });

        // í¼ ì œì¶œ
        document.getElementById('reviewForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            if (!Create) {
                alert('ì´ë¯¸ ë¦¬ë·°ë¥¼ ì‘ì„±í•˜ì…¨ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ë³„ì  ì²´í¬
            if (selectedRating === 0) {
                alert('ë³„ì ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë‚´ìš© ì²´í¬
            const content = document.getElementById('reviewContent').value.trim();
            if (content.length < 20) {
                alert('ë¦¬ë·°ëŠ” ìµœì†Œ 20ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ë¡œë”© í‘œì‹œ
            const btnText = document.getElementById('btnText');
            const btnSpinner = document.getElementById('btnSpinner');
            const submitBtn = document.getElementById('submitBtn');
            
            btnText.style.display = 'none';
            btnSpinner.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            // í¼ ì œì¶œ
            this.submit();
        });

        // ì„±ê³µ í›„ ì´ë™
        function goToProduct() {
            window.location.href = '/product/detail/' + productId + '#reviews';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ì¡´ ë¦¬ë·°ê°€ ìˆìœ¼ë©´ ë²„íŠ¼ ë¹„í™œì„±í™”
        if (!canWrite) {
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('reviewContent').disabled = true;
        }
    </script> -
</body>
</html>-->